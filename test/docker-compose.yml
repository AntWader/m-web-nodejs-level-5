version: '3'
services:
  test-web:
    depends_on:
      - test-db
    container_name: swapi.web
    build: ../
    command: >
      bash -c "npm run test
      && npm run test:e2e"
    ports:
      - "3000:3000"

  test-db:
    container_name: swapi.mysql
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=test_db
    ports:
      - 3106:3306
    volumes:
      - test-mysql:/var/lib/mysql

volumes:
  test-mysql:
    driver: local